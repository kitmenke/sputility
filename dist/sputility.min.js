/*
   Name: SPUtility.js
   Version: 0.14.2
   Built: 2016-05-17
   Author: Kit Menke
   https://sputility.codeplex.com/
   Copyright (c) 2016
   License: The MIT License (MIT)
*/
Object.create||(Object.create=function(a){function b(){}if(arguments.length>1)throw new Error("Object.create implementation only accepts the first parameter.");return b.prototype=a,new b}),function(a,b){"object"==typeof exports?module.exports=function(c){return c=c||b.jQuery,a(b,c)}:"function"==typeof define&&define.amd?define(["jquery"],function(c){return a(b,c)}):a(b,!1)}(function(a,b){"use strict";function c(){return null===Z&&(Z=b("table.ms-formtoolbar input[value='Close']").length>=1),Z}function d(){return navigator.userAgent.toLowerCase().indexOf("msie")>=0}function e(a){return"undefined"==typeof a}function f(a){return"string"==typeof a}function g(a){return"number"==typeof a}function h(a){return parseInt(a,10)}function i(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function j(a,b,c){return a.replace(new RegExp(i(b),"g"),c)}function k(a){return"string"==typeof a&&(a=j(a," ",""),a=j(a,_.thousandsSeparator,""),a=a.replace(_.decimalSeparator,"."),a=parseFloat(a)),a}function l(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/''/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function m(){return 15===$}function n(a,b,c,d){b=isNaN(b=Math.abs(b))?2:b,c=void 0===c?_.decimalSeparator:c,d=void 0===d?_.thousandsSeparator:d;var e=0>a?"-":"",f=parseInt(a=Math.abs(+a||0).toFixed(b),10)+"",g=(g=f.length)>3?g%3:0;return e+(g?f.substr(0,g)+d:"")+f.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+d)+(b?c+Math.abs(a-f).toFixed(b).slice(2):"")}function o(a){if(null===a.Controls)return null;var c=b(a.Controls).find("input");if(null!==c&&1===c.length)return c[0];throw"Unable to retrieve the input control for "+a.Name}function p(a,c){var d,e=[],f=b(a.Controls).find(c),g=b(a.Controls).find("label");if(g.length<f.length)throw"Unable to get hashtable of controls.";for(d=0;d<f.length;d++)e.push({key:b(g[d]).text(),value:f[d]});return e}function q(a,c){var d=null;return b(a).each(function(a,b){return b.key===c?(d=b.value,!1):void 0}),d}function r(a,c){for(var d=0;d<a.childNodes.length;d+=1)if(8===a.childNodes[d].nodeType){var e=a.childNodes[d].data,f=e.match(/SPField\w+/);null!==f&&f.length>0&&(c.type=f[0]);var g=e.match(/FieldName="[^"]+/);null!==g&&g.length>0&&(c.name=g[0].substring(11));var h=e.match(/FieldInternalName="\w+/);null!==h&&h.length>0&&(c.internalName=h[0].substring(19));break}null===c.type&&b(a).find("select[name$=ContentTypeChoice]").length>0&&(c.type="ContentTypeChoice",c.internalName="ContentType",c.name="Content Type")}function s(a){var c=null,d=null,e=b(a).siblings(".ms-formlabel");if(null!==e){var f=e.children("h3");if(c=f.length>0?f[0]:e,null!==c&&"NOBR"!==c.nodeName){var g=b.trim(b(c).text());g.length>2&&" *"===g.substring(g.length-2)&&(d=!0)}}var h={name:null,internalName:null,label:null!==c?b(c):null,labelRow:null!==c?c.parentNode:null,labelCell:e,isRequired:d,controlsRow:a.parentNode,controlsCell:a,type:null,spField:null};return r(a,h),h}function t(){if(null===X||null===Y){"object"==typeof _spPageContextInfo&&($=15===_spPageContextInfo.webUIVersion?15:14),X={},Y={};for(var a=b("table.ms-formtable td.ms-formbody"),c=0;c<a.length;c+=1){var d=s(a[c]);null!==d&&(X[d.name]=d,Y[d.internalName]=d)}}}function u(a,c,d){d?(null!==a&&b(a).show(),b(c).show()):(null!==a&&b(a).hide(),b(c).hide())}function v(a,b){t();var c=X[a];if(e(c))throw"toggleSPField: Unable to find a SPField named "+a+" - "+b;u(c.labelRow,c.controlsRow,b)}function w(a){this.Label=a.label,this.LabelRow=a.labelRow,this.Name=a.name,this.InternalName=a.internalName,this.IsRequired=a.isRequired,this.Type=a.type;var c=b(a.controlsCell).children().not("script");c.length>0?this.Controls=c[0]:this.Controls=null,this.ControlsRow=a.controlsRow,this.ReadOnlyLabel=null}function x(a){w.call(this,a),this.Textbox=o(this)}function y(a){x.call(this,a)}function z(a){y.call(this,a),this.FormatOptions={eventHandler:null,autoCorrect:!1,decimalPlaces:2}}function A(a){w.call(this,a),null!==this.Controls&&(this.Dropdown=this.Controls)}function B(a){if(w.call(this,a),null!==this.Controls){var c=b(this.Controls).find("input"),d=c.length;d>1&&"text"===c[d-1].type?(this.FillInTextbox=c[d-1],this.FillInElement=c[d-2],this.FillInAllowed=!0):(this.FillInAllowed=!1,this.FillInTextbox=null,this.FillInElement=null)}}function C(a,b){B.call(this,a),null!==this.Controls&&(this.Dropdown=b,this.Dropdown=1===this.Dropdown.length?this.Dropdown[0]:[])}function D(a){B.call(this,a),null!==this.Controls&&(this.RadioButtons=p(this,'input[type="radio"]'),this.FillInAllowed&&this.RadioButtons.pop())}function E(a){B.call(this,a),null!==this.Controls&&(this.Checkboxes=p(this,'input[type="checkbox"]'),this.FillInAllowed&&(this.FillInElement=this.Checkboxes.pop().value))}function F(a,b,c,d,f,g,h){this.Year=null,this.Month=null,this.Day=null,this.IsTimeIncluded=!1,this.Hour=null,this.Minute=null,this.TimeFormat=null,this.DateSeparator=null,e(a)||e(b)||e(c)||(this.SetDate(a,b,c),e(d)||e(f)||(this.SetTime(d,f),e(g)||(this.TimeFormat=g,e(h)||(this.DateSeparator=h))))}function G(a){if(w.call(this,a),this.DateTextbox=o(this),this.HourDropdown=null,this.MinuteDropdown=null,this.IsDateOnly=!0,this.HourValueFormat=null,null!==this.Controls){var c=b(this.Controls).find("select");null!==c&&2===c.length&&(this.HourDropdown=c[0],b(this.HourDropdown).val().indexOf(" ")>-1?this.HourValueFormat="string":this.HourValueFormat="number",this.MinuteDropdown=c[1],this.IsDateOnly=!1)}}function H(a){w.call(this,a),this.Checkbox=o(this)}function I(a){if(w.call(this,a),null!==this.Controls){this.TextboxURL=null,this.TextboxDescription=null,this.TextOnly=!1;var c=b(this.Controls).find("input");null!==c&&2===c.length&&(this.TextboxURL=b(c[0]),this.TextboxDescription=b(c[1]))}}function J(a,b){if(w.call(this,a),null!==this.Controls){if(1!==b.length)throw"Unable to get dropdown element for "+this.Name;this.Dropdown=b[0]}}function K(a,c){if(w.call(this,a),null!==this.Controls){if(1!==c.length)throw"Unable to get input elements for "+this.Name;this.Textbox=b(c[0]),this.HiddenTextbox=b('input[id="'+this.Textbox.attr("optHid")+'"]')}}function L(a,b){w.call(this,a),this.Textbox=b,this.TextType="Plain"}function M(a,b){L.call(this,a,b),this.TextType="Rich"}function N(a,c){w.call(this,a),this.Textbox=c[0],this.ContentDiv=b(this.Controls).find('div[contenteditable="true"]')[0],this.TextType="Enhanced"}function O(a){x.call(this,a),this.FileExtension=b(this.Textbox).parent().text()}function P(a){if(w.call(this,a),null!==this.Controls){var c=b(this.Controls).find("select");if(2!==c.length)throw"Error initializing SPLookupMultiField named "+this.Name+", unable to get select controls.";this.ListChoices=c[0],this.ListSelections=c[1],c=b(this.Controls).find("button"),0===c.length&&(c=b(this.Controls).find('input[type="button"]')),this.ButtonAdd=c[0],this.ButtonRemove=c[1]}}function Q(a){if(w.call(this,a),null!==this.Controls){this.spanUserField=null,this.upLevelDiv=null,this.textareaDownLevelTextBox=null,this.linkCheckNames=null,this.txtHiddenSpanData=null;var c=b(this.Controls).find("span.ms-usereditor");null!==c&&1===c.length&&(this.spanUserField=c[0],this.upLevelDiv=byid(this.spanUserField.id+"_upLevelDiv"),this.textareaDownLevelTextBox=byid(this.spanUserField.id+"_downlevelTextBox"),this.linkCheckNames=byid(this.spanUserField.id+"_checkNames"),this.txtHiddenSpanData=byid(this.spanUserField.id+"_hiddenSpanData"))}}function R(a){if(w.call(this,a),null!==this.Controls){var c=b(this.Controls).children()[0];this.ClientPeoplePicker=window.SPClientPeoplePicker.SPClientPeoplePickerDict[b(c).attr("id")],this.EditorInput=b(this.Controls).find("[id$='_EditorInput']")[0]}}function S(a,b){w.call(this,a),this.Controls=a.controlsCell,this.TextNode=b}function T(a,b){w.call(this,a),this.Controls=a.controlsCell,this.Element=b}function U(a){var d,e=null;if(c())return d=a.controlsCell.childNodes,5===d.length?new T(a,d[3]):new S(a,d[2]);switch(a.type){case"SPFieldText":e=new x(a);break;case"SPFieldNumber":e=new y(a);break;case"SPFieldCurrency":e=new z(a);break;case"ContentTypeChoice":e=new A(a);break;case"SPFieldChoice":d=b(a.controlsCell).find("select"),e=d.length>0?new C(a,d):new D(a);break;case"SPFieldMultiChoice":e=new E(a);break;case"SPFieldDateTime":e=new G(a);break;case"SPFieldBoolean":e=new H(a);break;case"SPFieldUser":case"SPFieldUserMulti":case"SPFieldBusinessData":e="undefined"==typeof window.SPClientPeoplePicker?new Q(a):new R(a);break;case"SPFieldURL":e=new I(a);break;case"SPFieldLookup":d=b(a.controlsCell).find("select"),d.length>0?e=new J(a,d):(d=b(a.controlsCell).find("input"),e=new K(a,d));break;case"SPFieldNote":d=b(a.controlsCell).find("textarea"),d.length>0?(d=d[0],window.RTE_GetEditorIFrame&&null!==window.RTE_GetEditorIFrame(d.id)&&(e=new M(a,d))):(d=b(a.controlsCell).find('input[type="hidden"]'),d.length>=1&&(e=new N(a,d))),null===e&&(e=new L(a,d));break;case"SPFieldFile":e=new O(a);break;case"SPFieldLookupMulti":e=new P(a);break;default:e=new w(a)}return e}function V(a){try{if(null===a.type)throw"Unknown SPField type.";return U(a)}catch(b){throw"Error creating field named "+a.name+": "+b.toString()}}var W=b===!1;if(b=b||a.jQuery,!b||!b.fn)throw"JsViews requires jQuery";var X=null,Y=null,Z=null,$=12,_={timeFormat:"12HR",dateSeparator:"/",decimalSeparator:".",thousandsSeparator:",",stringYes:"Yes",stringNo:"No"};w.prototype.Show=function(){return u(this.LabelRow,this.ControlsRow,!0),this},w.prototype.Hide=function(){return u(this.LabelRow,this.ControlsRow,!1),this},w.prototype.GetDescription=function(){if(m())return b(this.Controls.parentNode).children("span.ms-metadata").text();var a=this.Controls.parentNode,c=b(b(a).contents().toArray().reverse()).filter(function(){return 3===this.nodeType}).text();return c.replace(/^\s+/,"").replace(/\s+$/g,"")},w.prototype.SetDescription=function(a){var c;if(a=e(a)?"":a,m())c=b(this.Controls.parentNode).children("span.ms-metadata"),0===c.length&&(c=b('<span class="ms-metadata"/>'),b(this.Controls.parentNode).append(c)),b(c).html(a);else{c=this.Controls.parentNode;var d=b(b(c).contents().toArray().reverse()).filter(function(){return 3===this.nodeType});0===d.length?(d=document.createTextNode(a),c.appendChild(d)):b(d)[0].nodeValue=a}},w.prototype._updateReadOnlyLabel=function(a){this.ReadOnlyLabel&&this.ReadOnlyLabel.html(a)},w.prototype._makeReadOnly=function(a){try{b(this.Controls).hide(),null===this.ReadOnlyLabel&&(this.ReadOnlyLabel=b("<div/>").addClass("sputility-readonly"),b(this.Controls).after(this.ReadOnlyLabel)),this.ReadOnlyLabel.html(a),this.ReadOnlyLabel.show()}catch(c){throw"Error making "+this.Name+" read only. "+c.toString()}return this},w.prototype.MakeReadOnly=function(){return this._makeReadOnly(this.GetValue().toString())},w.prototype.MakeEditable=function(){try{b(this.Controls).show(),null!==this.ReadOnlyLabel&&b(this.ReadOnlyLabel).hide()}catch(a){throw"Error making "+this.Name+" editable. "+a.toString()}return this},w.prototype.toString=function(){return this.Name},w.prototype.GetValue=function(){throw"GetValue not yet implemented for "+this.Type+" in "+this.Name},w.prototype.SetValue=function(){throw"SetValue not yet implemented for "+this.Type+" in "+this.Name},x.prototype=Object.create(w.prototype),x.prototype.GetValue=function(){return b(this.Textbox).val()},x.prototype.SetValue=function(a){return b(this.Textbox).val(a),this._updateReadOnlyLabel(this.GetValue().toString()),this},x.prototype.MakeReadOnly=function(){return this._makeReadOnly(l(this.GetValue()))},y.prototype=Object.create(x.prototype),y.prototype.GetValue=function(){return k(b(this.Textbox).val())},y.prototype.SetValue=function(a){return b(this.Textbox).val(a),this._updateReadOnlyLabel(this.GetValueString()),this},y.prototype.GetValueString=function(){var a=this.GetValue();return a=isNaN(a)?"":a.toString()},y.prototype.MakeReadOnly=function(){return this._makeReadOnly(this.GetValueString())},z.prototype=Object.create(y.prototype),z.prototype.Format=function(){this.FormatOptions.autoCorrect?(this.FormatOptions.eventHandler=b.proxy(function(){this.SetValue(this.GetFormattedValue())},this),b(this.Textbox).on("change",this.FormatOptions.eventHandler),this.FormatOptions.eventHandler()):this.FormatOptions.eventHandler&&(b(this.Textbox).off("change",this.FormatOptions.eventHandler),this.FormatOptions.eventHandler=null)},z.prototype.GetFormattedValue=function(){var a=this.GetValue();return"number"==typeof a&&(a=n(a,this.FormatOptions.decimalPlaces)),a},z.prototype.SetValue=function(a){return b(this.Textbox).val(a),this._updateReadOnlyLabel(this.GetFormattedValue()),this},z.prototype.MakeReadOnly=function(){return this._makeReadOnly(this.GetFormattedValue())},A.prototype=Object.create(w.prototype),A.prototype.GetValue=function(){return this.Dropdown.options[this.Dropdown.selectedIndex].text},A.prototype.SetValue=function(a){var b,c,d;for(c=this.Dropdown.options,b=0;b<c.length;b+=1)if(d=c[b],d.text===a||d.value===a){this.Dropdown.selectedIndex=b,"function"==typeof ChangeContentType&&ChangeContentType(this.Dropdown.id);break}return this._updateReadOnlyLabel(this.GetValue()),this},B.prototype=Object.create(w.prototype),B.prototype._getFillInValue=function(){return b(this.FillInTextbox).val()},B.prototype._setFillInValue=function(a){this.FillInElement.checked=!0,b(this.FillInTextbox).val(a)},C.prototype=Object.create(B.prototype),C.prototype.GetValue=function(){return this.FillInAllowed&&this.FillInElement.checked===!0?this._getFillInValue():b(this.Dropdown).val()},C.prototype.SetValue=function(a){var c=b(this.Dropdown).find('option[value="'+a+'"]').length>0;if(!c&&this.FillInAllowed)c?(b(this.Dropdown).val(a),this.FillInElement.checked=!1):this._setFillInValue(a);else{if(!c)throw"Unable to set value for "+this.Name+' the value "'+a+'" was not found.';b(this.Dropdown).val(a)}return this._updateReadOnlyLabel(this.GetValue().toString()),this},D.prototype=Object.create(B.prototype),D.prototype.GetValue=function(){var a=null;return b(this.RadioButtons).each(function(b,c){var d=c.value;return d.checked?(a=c.key,!1):void 0}),this.FillInAllowed&&null===a&&this.FillInElement.checked===!0&&(a=b(this.FillInTextbox).val()),a},D.prototype.SetValue=function(a){var b=q(this.RadioButtons,a);if(null===b){if(!this.FillInAllowed)throw"Unable to set value for "+this.Name+' the value "'+a+'" was not found.';this._setFillInValue(a)}else b.checked=!0;return this._updateReadOnlyLabel(this.GetValue().toString()),this},E.prototype=Object.create(B.prototype),E.prototype.MakeReadOnly=function(){return this._makeReadOnly(this.GetValue().join("; "))},E.prototype.GetValue=function(){var a=[];return b(this.Checkboxes).each(function(b,c){var d=c.value;d.checked&&a.push(c.key)}),this.FillInAllowed&&this.FillInElement.checked===!0&&a.push(b(this.FillInTextbox).val()),a},E.prototype.SetValue=function(a,c){var d=q(this.Checkboxes,a);if(c=e(c)?!0:c,null===d){if(!this.FillInAllowed)throw"Unable to set value for "+this.Name+' the value "'+a+'" was not found.';d=this.FillInElement,b(this.FillInTextbox).val(a),d.checked=c}else d.checked=c;return this._updateReadOnlyLabel(this.GetValue().join("; ")),this},F.prototype.SetDate=function(a,b,c){if(f(a)&&(a=h(a)),f(b)&&(b=h(b)),f(c)&&(c=h(c)),!g(a)||!g(b)||!g(c))throw"Unable to set date, invalid arguments (requires year, month, and day as integers).";this.Year=a,this.Month=b,this.Day=c},F.prototype.SetTime=function(a,b){if(this.IsTimeIncluded=!1,g(a)){if(0>a||a>23)throw"Hour number parameter must be between 0 and 23.";this.Hour=a}else if(f(a)){if(!this.IsValidHour(a))throw'Hour string parameter must be formatted like "1 PM" or "12 AM".';this.Hour=this.ConvertHourToNumber(a)}if(g(b)){if(0>b||b>=60||b%5!==0)throw"Minute parameter is not in the correct format. Needs to be formatted like 0, 5, or 35.";this.Minute=b}else if(f(b)){if(!this.IsValidMinute(b))throw'Minute parameter is not in the correct format. Needs to be formatted like "00", "05" or "35".';this.Minute=h(b)}this.IsTimeIncluded=!0},F.prototype.IsValidDate=function(){return null!==this.Year&&null!==this.Month&&null!==this.Day},F.prototype.IsValidHour=function(a){return!e(a)&&/^([1-9]|10|11|12) (AM|PM)$/.test(a)},F.prototype.IsValidMinute=function(a){return!e(a)&&/^([0-5](0|5))$/.test(a)},F.prototype.ConvertHourToNumber=function(a){var b;return a=a.split(" "),b=h(a[0]),"AM"===a[1]?12===b&&(b=0):"PM"===a[1]&&(b+=12),b},F.prototype.PadWithZero=function(a){return e(a)||null===a?"":f(a)&&(a=h(a),isNaN(a))?"":g(a)&&10>a?"0"+a.toString():a.toString()},F.prototype.GetShortDateString=function(){if(!this.IsValidDate())return"";var a;return a="12HR"===this.TimeFormat?this.Month+_.dateSeparator+this.Day+_.dateSeparator+this.Year:this.PadWithZero(this.Day)+_.dateSeparator+this.PadWithZero(this.Month)+_.dateSeparator+this.Year},F.prototype.GetHour=function(){var a=this.Hour;return"12HR"===this.TimeFormat&&(0===a?a=12:a>12&&(a-=12)),a},F.prototype.GetShortTimeString=function(){return this.IsTimeIncluded?"12HR"===this.TimeFormat?this.GetHour()+":"+this.PadWithZero(this.Minute)+(this.Hour<12?" AM":" PM"):this.PadWithZero(this.GetHour())+":"+this.PadWithZero(this.Minute):""},F.prototype.toString=function(){var a=this.GetShortDateString(),b=this.GetShortTimeString();return""===a&&""===b?"":""===a?"":""===b?a:a+" "+b},G.prototype=Object.create(w.prototype),G.prototype.GetValue=function(){var a,c,d=b(this.DateTextbox).val().split(_.dateSeparator),e=new F;if(e.TimeFormat=_.timeFormat,e.DateSeparator=_.dateSeparator,3===d.length){var f,g,i;"12HR"===_.timeFormat?(g=d[0],i=d[1],f=d[2]):(i=d[0],g=d[1],f=d[2]),e.SetDate(f,g,i)}return this.IsDateOnly||(a=b(this.HourDropdown).val(),"number"===this.HourValueFormat&&(a=h(a)),c=b(this.MinuteDropdown).val(),e.SetTime(a,c)),e},G.prototype.SetValue=function(a,b,c,d,f){return e(a)||null===a||""===a?(this.SetDate(null),this.IsDateOnly||this.SetTime(null),this):(this.SetDate(a,b,c),e(d)||e(f)||this.SetTime(d,f),this)},G.prototype.SetDate=function(a,c,d){if(null===a||""===a)return b(this.DateTextbox).val(""),this;var e=new F;return e.TimeFormat=_.timeFormat,e.DateSeparator=_.dateSeparator,e.SetDate(a,c,d),b(this.DateTextbox).val(e.GetShortDateString()),this._updateReadOnlyLabel(this.GetValue().toString()),this},G.prototype.SetTime=function(a,c){if(this.IsDateOnly)throw"Unable to set the time for a Date only field.";var d=new F;if(d.TimeFormat=_.timeFormat,d.DateSeparator=_.dateSeparator,null===a||""===a?d.SetTime(0,0):d.SetTime(a,c),"string"===this.HourValueFormat){var e;e=0===d.Hour?"12 AM":12===d.Hour?"12 PM":d.Hour>12?(d.Hour-12).toString()+" PM":d.Hour.toString()+" AM",b(this.HourDropdown).val(e)}else b(this.HourDropdown).val(d.Hour);return b(this.MinuteDropdown).val(d.PadWithZero(d.Minute)),this._updateReadOnlyLabel(this.GetValue().toString()),this},H.prototype=Object.create(w.prototype),H.prototype.GetValue=function(){return!!this.Checkbox.checked},H.prototype.GetValueString=function(){return this.GetValue()?_.stringYes:_.stringNo},H.prototype.SetValue=function(a){return a=f(a)?_.stringYes.toUpperCase()===a.toUpperCase():!!a,this.Checkbox.checked=a,this._updateReadOnlyLabel(this.GetValueString()),this},H.prototype.MakeReadOnly=function(){return this._makeReadOnly(this.GetValueString())},I.prototype=Object.create(w.prototype),I.prototype.GetValue=function(){return[this.TextboxURL.val(),this.TextboxDescription.val()]},I.prototype.SetValue=function(a,b){return this.TextboxURL.val(a),this.TextboxDescription.val(b),this._updateReadOnlyLabel(this.GetHyperlink()),this},I.prototype.GetHyperlink=function(){var a,b=this.GetValue();return a=this.TextOnly?b[0]+", "+b[1]:'<a href="'+b[0]+'">'+b[1]+"</a>"},I.prototype.MakeReadOnly=function(a){return a&&!0===a.TextOnly&&(this.TextOnly=!0),this._makeReadOnly(this.GetHyperlink())},J.prototype=Object.create(w.prototype),J.prototype.GetValue=function(){return this.Dropdown.options[this.Dropdown.selectedIndex].text},J.prototype.SetValue=function(a){if(g(a))b(this.Dropdown).val(a);else{var c,d,e;for(d=this.Dropdown.options,c=0;c<d.length;c+=1)if(e=d[c],e.text===a){this.Dropdown.selectedIndex=c;break}}return this._updateReadOnlyLabel(this.GetValue()),this},K.prototype=Object.create(w.prototype),K.prototype.GetValue=function(){return this.Textbox.val()},K.prototype.SetValue=function(a){var b,c,d,e,g,i=[];for(b=this.Textbox.attr("choices"),b=b.split(/\|(?=\d+)/),i.push(b[0]),e=1;e<b.length-1;e++)g=b[e].indexOf("|"),i.push(b[e].substring(0,g)),i.push(b[e].substring(g+1));for(i.push(b[b.length-1]),f(a)&&(a=a.replace("|","||")),e=0;e<i.length;e+=2)if(c=h(i[e+1]),d=i[e],a===c||a===d){this.Textbox.val(d.replace("||","|"));break}return null!==c&&this.HiddenTextbox.val(c),this._updateReadOnlyLabel(this.GetValue()),this},L.prototype=Object.create(w.prototype),L.prototype.GetValue=function(){return b(this.Textbox).val()},L.prototype.SetValue=function(a){return b(this.Textbox).val(a),this._updateReadOnlyLabel(this.GetValue()),this},M.prototype=Object.create(L.prototype),M.prototype.GetValue=function(){return window.RTE_GetIFrameContents(this.Textbox.id)},M.prototype.SetValue=function(a){return b(this.Textbox).val(a),window.RTE_TransferTextAreaContentsToIFrame(this.Textbox.id),this._updateReadOnlyLabel(this.GetValue()),this},N.prototype=Object.create(w.prototype),N.prototype.GetValue=function(){return b(this.ContentDiv).html()},N.prototype.SetValue=function(a){return b(this.ContentDiv).html(a),b(this.Textbox).val(a),this._updateReadOnlyLabel(this.GetValue()),this},O.prototype=Object.create(x.prototype),O.prototype.GetValue=function(){return b(this.Textbox).val()+this.FileExtension},P.prototype=Object.create(w.prototype),P.prototype.GetValue=function(){var a,b,c=[];for(b=this.ListSelections.options.length,a=0;b>a;a+=1)c.push(this.ListSelections.options[a].text);return c},P.prototype.MakeReadOnly=function(){return this._makeReadOnly(this.GetValue().join("; "))},P.prototype.SetValue=function(a,c){e(c)&&(c=!0);var d,f,h,i,j,k;for(c?(h=this.ListChoices.options,j=this.ButtonAdd):(h=this.ListSelections.options,j=this.ButtonRemove),i=h.length,g(a)?(a=a.toString(),k="value"):k="text",d=0;i>d;d+=1){if(f=h[d],f[k]===a){f.selected=!0;break}f.selected=!1}return j.disabled="",b(j).click(),this._updateReadOnlyLabel(this.GetValue().join("; ")),this},Q.prototype=Object.create(w.prototype),Q.prototype.GetValue=function(){return b(this.upLevelDiv).text().replace(/^\s+|\u00A0|\s+$/g,"")},Q.prototype.SetValue=function(a){return this.upLevelDiv.innerHTML=a,this.textareaDownLevelTextBox.innerHTML=a,d()&&b(this.txtHiddenSpanData).val(a),this.linkCheckNames.click(),this._updateReadOnlyLabel(this.GetValue()),this},R.prototype=Object.create(w.prototype),R.prototype.GetValue=function(){return this.ClientPeoplePicker.GetAllUserInfo()},R.prototype._getValueLinks=function(a){function c(a){var b={users:a.users};a.d.resolve(b)}function d(a){a.d.reject("Something went wrong...")}function e(a,e){for(var f=b.Deferred(),g=new SP.ClientContext.get_current,h=a.length,i=[],j=0;h>j;j++){var k=g.get_web().ensureUser(a[j]);g.load(k),i.push(k)}var l={d:f,loginNames:a,users:i};return g.executeQueryAsync(c.bind(e,l),d.bind(e,l)),f.promise()}var f=[],g=this;b.each(g.GetValue(),function(a,b){null!==b.Key&&f.push(b.Key)});var h=e(f,g);h.done(function(b){for(var c="",d=0;d<b.users.length;d++){var e=b.users[d];""!==c&&(c+="; "),c+='<a href="/_layouts/15/userdisp.aspx?ID='+e.get_id().toString()+'&amp;RootFolder=*">'+e.get_title()+"</a>"}return a(c)}),h.fail(function(a){var b=a;console.log(b)})},R.prototype._updateReadOnlyLabel=function(){var a=this;a.ReadOnlyLabel&&this._getValueLinks(function(b){a.ReadOnlyLabel.html(b)})},R.prototype.GetValueString=function(){return b.map(this.GetValue(),function(a){return a.DisplayText}).join(", ")},R.prototype.SetValue=function(a){return e(a)||null===a||""===a?this.ClientPeoplePicker.DeleteProcessedUser():(b(this.EditorInput).val(a),this.ClientPeoplePicker.AddUnresolvedUserFromEditor(!0)),this._updateReadOnlyLabel(),this},R.prototype.MakeReadOnly=function(){return this._makeReadOnly(""),this._updateReadOnlyLabel(),this},S.prototype=Object.create(w.prototype),S.prototype.GetValue=function(){return b.trim(b(this.TextNode).text())},S.prototype.SetValue=function(a){return this.TextNode.nodeValue=a,this},S.prototype.MakeEditable=function(){return this},S.prototype.MakeReadOnly=function(){return this},T.prototype=Object.create(w.prototype),T.prototype.GetValue=function(){return b(this.Element).text()},T.prototype.SetValue=function(){return this},T.prototype.MakeEditable=function(){return this},T.prototype.MakeReadOnly=function(){return this};var aa={};return aa.Debug=function(){return!1},aa.GetSPField=function(a){t();var b=X[a];if(e(b))throw"Unable to get a SPField named "+a;return null===b.spField&&(b.spField=V(b)),b.spField},aa.GetSPFieldByInternalName=function(a){t();var b=Y[a];if(e(b))throw"Unable to get a SPField with internal name "+a;return null===b.spField&&(b.spField=V(b)),b.spField},aa.GetSPFields=function(){return t(),X},aa.GetSPFieldsInternal=function(){return t(),Y},aa.HideSPField=function(a){v(a,!1)},aa.ShowSPField=function(a){v(a,!0)},aa.IsDispForm=function(){return c()},aa.Setup=function(a){var c=b.extend({},_,a);if("12HR"!==c.timeFormat&&"24HR"!==c.timeFormat)throw"Unable to set timeFormat, should be 12HR or 24HR.";return _=c,c},aa.GetTimeFormat=function(){return _.timeFormat},aa.SetTimeFormat=function(a){aa.Setup({timeFormat:a})},aa.GetDateSeparator=function(){return _.dateSeparator},aa.SetDateSeparator=function(a){aa.Setup({dateSeparator:a})},aa.GetDecimalSeparator=function(){return _.decimalSeparator},aa.SetDecimalSeparator=function(a){aa.Setup({decimalSeparator:a})},aa.GetThousandsSeparator=function(){return _.thousandsSeparator},aa.SetThousandsSeparator=function(a){aa.Setup({thousandsSeparator:a})},W&&(a.SPUtility=aa),aa},window);